const { spawn } = require('child_process');

// Initialize the process but don't start it immediately if concerned about missing early output
const command1 = spawn('sh', ['../bff.sh'], { shell: true, stdio: ['inherit', 'pipe', 'pipe'] });

// Setup your event handlers immediately
command1.stdout.on('data', (data) => {
  console.log(`command1: ${data}`);
  if (data.toString().includes('Ready to start command2')) {
    // Start command2
    const command2 = spawn('command2', { shell: true, stdio: 'inherit' });
  }
});

command1.stderr.on('data', (data) => {
  console.error(`command1: ${data}`);
});

command1.on('close', (code) => {
  console.log(`command1 exited with code ${code}`);
});
